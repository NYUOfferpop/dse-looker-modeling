# calculate run rate with the days with MQL
select count(Original_Source__c) as source_count, count(distinct Contact_Created_Date__c) as date_count, count(Original_Source__c)/count(distinct Contact_Created_Date__c) as Run_rate
from sfdc_contact
where Contact_Created_Date__c like '2014%'

# measures in LookML
 - measure: run_rate
    type: number
    sql: count(${TABLE}.Original_Source__c)/ count(${TABLE}.Contact_Created_Date__c)
  
  # remains to be changed
  - measure: run_rate_monthly_projection
    type: number
    sql: count(${TABLE}.Original_Source__c)/ ${TABLE}.Contact_Created_Date__c *30
  
  # remains to be changed
  - measure: run_rate_quarterly_projection
    type: number
    sql: count(${TABLE}.Original_Source__c)/ ${TABLE}.Contact_Created_Date__c *90
  
  # remains to be changed
  - measure: run_rate_yearly_projection
    type: number
    sql: count(${TABLE}.Original_Source__c)/ ${TABLE}.Contact_Created_Date__c *360
    
    
#############################################
https://discourse.looker.com/t/compare-custom-date-ranges-or-any-custom-tiers-enable-end-users-to-run-these-queries-at-will/474
https://discourse.looker.com/t/filter-on-multiple-date-ranges-or-filters-between-dates/650
https://discourse.looker.com/t/comparison-against-population/255

# Select the current date 
SELECT NOW(),CURDATE(),CURTIME()

# Get the date diff of selected date and now
SELECT DATEDIFF(NOW(),'2015-03-07')

# Get the date diff of selected date and now, absolute value
SELECT ABS(DATEDIFF('2015-03-07',NOW()))

# # Get the date diff between any date, absolute value
SELECT ABS(DATEDIFF('2015-03-07', '2015-07-09'))

https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html
http://sys-exit.blogspot.com/2013/06/mysql-today-tomorrow-yesterday-this.html

# Find the first day of the month
select CAST(DATE_FORMAT(NOW() ,'%Y-%m-01') as DATE);

# Calculate the first day and last day of next month
SELECT
DATE_SUB(
    LAST_DAY(
        DATE_ADD(NOW(), INTERVAL 1 MONTH)
    ), 
    INTERVAL DAY(
        LAST_DAY(
            DATE_ADD(NOW(), INTERVAL 1 MONTH)
        )
    )-1 DAY
) AS firstOfNextMonth,

LAST_DAY(
    DATE_ADD(NOW(), INTERVAL 1 MONTH)
)AS lastOfNextMonth

# Select the last day of the month
SELECT LAST_DAY(NOW())

# Select the # of days till the end of the month
SELECT ABS(DATEDIFF(now(),LAST_DAY(NOW())))

# FIRST DAY OF CURRENT QUARTER
SELECT  MAKEDATE(YEAR(CURDATE()), 1) + INTERVAL QUARTER(CURDATE()) QUARTER - INTERVAL 1 QUARTER

# LAST DAY OF LAST QUARTER
SELECT  MAKEDATE(YEAR(CURDATE()), 1) + INTERVAL QUARTER(CURDATE()) QUARTER - INTERVAL 1 QUARTER - INTERVAL 1 DAY
 
# LAST DAY OF CURRENT QUARTER
SELECT  MAKEDATE(YEAR(CURDATE()), 1) + INTERVAL QUARTER(CURDATE()) QUARTER - INTERVAL 1 DAY

# FIND THE DAYS LEFT FOR THE CURRENT MONTH, QUARTER AND YEAR
SELECT ABS(DATEDIFF(LAST_DAY(NOW()),NOW())) AS DAYS_LEFT_CUR_MONTH, 
 DATEDIFF(MAKEDATE(YEAR(NOW()),1) + INTERVAL QUARTER(NOW()) QUARTER - INTERVAL 1 DAY, NOW()) DATE_LEFT_CUR_QUARTER,
 DATEDIFF(MAKEDATE(YEAR(NOW()),365), NOW()) AS DAYS_LEFT_CUR_YEAR

 
# Current year record
SELECT COUNT(Original_Source__c)
FROM sfdc_contact
WHERE Contact_Created_Date__c between  MAKEDATE(YEAR(NOW()),1) + INTERVAL QUARTER(NOW()) QUARTER - INTERVAL 1 QUARTER and MAKEDATE(YEAR(NOW()),1) + INTERVAL QUARTER(NOW()) QUARTER - INTERVAL 1 DAY 
      
